<md-card class="expandable-header mat-elevation-z1" fxLayout="row">
    <div class="heading-wrapper cursor-pointer" fxFlex="95" (click)="toggleExpanded()" *ngIf="!editing">
        <h1 class="expandable-panel-heading" fxLayoutAlign="start center">
            <div fxFlex="90">
                {{ header }}
            </div>

            <div fxFlex="10" fxLayoutAlign="end">
                <md-icon [@iconChange]="isExpanded + ''">keyboard_arrow_up</md-icon>
            </div>
        </h1>
    </div>

    <div class="heading-wrapper" fxFlex="95" *ngIf="editing">
        <h1 class="expandable-panel-heading" fxLayoutAlign="start center">

            <div
                class="cursor-pointer"
                fxFlex="20"
                (click)="toggleExpanded()">
                {{ header }}
            </div>

            <div fxFlex="20">
                <md-input-container>
                  <input
                      mdInput
                      placeholder="Add Targeting"
                      [mdAutocomplete]="auto"
                      [formControl]="stateCtrl">
                </md-input-container>

                <md-autocomplete #auto="mdAutocomplete">
                  <md-option
                      *ngFor="let state of filteredResults | async"
                      [value]="state"
                      (onSelectionChange)="itemSelected($event)">
                    {{ state }}
                  </md-option>
                </md-autocomplete>
            </div>

            <div fxFlex="60" fxLayout="row">
                <md-chip-list [selectable]="false">
                  <md-chip *ngFor="let item of targets">{{ item }}</md-chip>
                </md-chip-list>
            </div>

            <div
                class="cursor-pointer"
                fxFlex="10"
                fxLayoutAlign="end"
                (click)="toggleExpanded()">
                <md-icon [@iconChange]="isExpanded + ''">keyboard_arrow_up</md-icon>
            </div>

        </h1>
    </div>

    <div class="menu-wrapper" fxFlex="5" fxLayoutAlign="center center">
        <md-menu #appMenu="mdMenu">
          <button
              md-menu-item
              (click)="editing = true"
              *ngIf="!editing">
              Edit
          </button>
          <button
              md-menu-item
              (click)="editing = false"
              *ngIf="editing">
              Save
          </button>
          <button md-menu-item>
                  Remove
              </button>
        </md-menu>

        <button md-icon-button [mdMenuTriggerFor]="appMenu">
           <md-icon>more_vert</md-icon>
        </button>
    </div>
</md-card>

<div class="expandable-content" [@expandChange]="isExpanded + ''">
    <ng-content></ng-content>
</div>
