<md-card class="trigger-details-card" fxFlex='100'>

    <form #form="ngForm" (ngSubmit)="submitForm(form)" class="padding" fxFlex='100' fxLayout="column">

        <div fxLayout="row">

            <div fxFlex="25">

                <div *ngIf="triggerType">

                    <div fxLayout="row" *ngIf="!parentCampaign" fxflex>

                        <md-select *ngIf="trigger"
                        placeholder="Campaign"
                        name="camnpaign"
                        [ngModel]="triggerCampaign"
                        (ngModelChange)="setCampaign($event)">
                            <md-option *ngFor="let campaign of campaigns" [value]="campaign">
                                {{ campaign.name }}
                            </md-option>
                        </md-select>

                    </div>

                    <div fxLayout="row">

                        <md-input-container fxFlex="75">
                            <input 
                                mdInput
                                name="name"
                                type="text"
                                placeholder="Name"
                                required
                                [(ngModel)]="trigger.name"
                                #name="ngModel">

                            <md-hint align="start">
                                <div  *ngIf="form.submitted && name.errors !== null && name.errors.required">
                                    Please add a name
                                </div>
                            </md-hint>
                        </md-input-container>

                    </div>

                </div>

                <div fxLayout="row">

                    <md-select 
                        fxflex="25"
                        placeholder="Type"
                        name="type"
                        [ngModel]="triggerType"
                        (ngModelChange)="setType($event)">
                            <md-option *ngFor="let type of triggerTypes" [value]="type.value">
                                {{ type.viewValue }}
                            </md-option>
                    </md-select>

                </div>

                <div fxLayout="row" *ngIf="!triggerType">
                    <p>To get started, please select a type.</p>
                </div>

                <div fxLayout="row" *ngIf="triggerType === 'beacon'">
                    <h4>Beacon(s)</h4>
                </div>

                <div fxLayout="row" *ngIf="triggerType === 'beacon'">

                    <md-list fxLayout="column" *ngIf="beacons">
                    <div fxLayout="row" *ngIf="!beacon">
                        <p>Please add a Beacon</p>
                    </div>
                        <md-list-item *ngFor="let beacon of beacons">
                            <p>{{beacon.uniqueId}}</p>
                            <span>
                                <md-icon md-list-icon>place</md-icon>
                               
                               <span class="app-toolbar-filler"></span>
                                <button type="button" md-icon-button>
                                <md-icon class="beacon-edit" md-list-icon (click)="beaconEdit($event)">edit</md-icon>
                                </button>
                            </span>

                        </md-list-item>
                    </md-list>

                </div>
                <div fxLayout="row" *ngIf="triggerType === 'geofence'">
                    <h4>Geofence Status:</h4>
                </div>

                <div fxLayout="row" *ngIf="triggerType === 'geofence'">
                    <div fxLayout="row" *ngIf="!geofence">
                        <p>Please add a Geofence</p>
                    </div>
                    <md-list fxLayout="row" *ngIf="geofence">
                        <p>Geofence added</p>
                        <md-list-item>
                            <span>
                               <span class="app-toolbar-filler"></span>
                                <button type="button" md-icon-button>
                                <md-icon class="beacon-edit" md-list-icon (click)="geofenceEdit($event)">edit</md-icon>
                                </button>
                            </span>

                        </md-list-item>
                    </md-list>

                </div>

                <div fxLayout="row" *ngIf="triggerType">
                    <h4>Delivery Preset: </h4>
                </div>

                <div fxLayout="row" *ngIf="triggerType">
                    <div fxLayout="row" *ngIf="!deliveryPreset">
                        <p>Please add a Delivery Preset.</p>
                    </div>

                    <md-list fxLayout="row" *ngIf="deliveryPreset">
                        <p>{{deliveryPreset.name}}</p>
                        <md-list-item>
                            <span>
                               
                               <span class="app-toolbar-filler"></span>
                                <button type="button" md-icon-button>
                                <md-icon class="beacon-edit" md-list-icon (click)="deliveryPresetEdit($event)">edit</md-icon>
                                </button>
                            </span>

                        </md-list-item>
                    </md-list>

                </div>

                <div  class="create-trigger-button" fxLayout="row" *ngIf="!editMode">

                    <button
                        type="submit" 
                        *ngIf="triggerType"
                        class="common-form-submit" 
                        md-raised-button 
                        [disabled]="!form.valid" 
                        color="primary">
                            Create Trigger
                    </button>

                </div>

                <div  class="create-trigger-button" fxLayout="row" *ngIf="editMode">

                    <button
                        type="submit" 
                        *ngIf="triggerType"
                        class="common-form-submit" 
                        md-raised-button 
                        [disabled]="!form.valid" 
                        color="primary">
                            Update Trigger
                    </button>

                </div>

            </div>

            <!-- right content-->
    
            <div fxFlex="75">

                <md-tab-group *ngIf="triggerType" class="highlight-well">

                    <md-tab label="Geofence Options" *ngIf="triggerType === 'geofence'">
                        <app-geofence-creator
                        [geofence]="geofence"
                        [trigger]="editTrigger"
                        (onCreate)="geofenceCreated($event)">
                        </app-geofence-creator>

                    </md-tab>


                    <md-tab label="Audio Options" *ngIf="triggerType === 'audio'">

                        <div fxFlex="70" fxLayout="column">
                            
                            <div fxLayout="row" class="right-column" fxLayoutAlign="center">

                                <div fxLayout="column" class="media-container">

                                    <div class="creator-section-label">
                                        Media
                                    </div>

                                    <div class="media-upload-container">
                                        <app-file-uploader
                                        [fileExists]="triggerMediaExists"
                                        [config]="triggerMediaConfig"
                                        (onUpload)="triggerMediaExists = $event">
                                        </app-file-uploader>
                                    </div>
                                    
                                </div>

                            </div>  

                        </div>

                    </md-tab>

                    <md-tab label="Beacon Options" *ngIf="triggerType === 'beacon'">

                        <!--beacon stuff-->
                        <app-beacon-creator
                            (onCreate)="beaconCreated($event)">
                        </app-beacon-creator>

                    </md-tab>

                    <md-tab label="Delivery Preset Options" *ngIf="triggerType">
                        
                        <div fxLayout="column" fxFlex="100">
                                
                                <app-delivery-preset-options
                                (onSelect)="presetSelected($event)"
                                [presetDelivery]="presetDelivery">
                                </app-delivery-preset-options>

                        </div>
            

                    </md-tab>

                </md-tab-group>

            </div>

        </div>

    </form>

</md-card>


